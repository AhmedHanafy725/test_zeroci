prerequisites:
  imageName: ahmedhanafy725/jsx

install: |
  apt-get update
  pip3 install click pytest loguru parameterized requests checksumdir xmltodict imbox logbook nltk imapclient
  eval `ssh-agent -s`; ssh-add
  cd /sandbox/code/github/threefoldtech/
  declare strs=('core' 'libs' 'libs_extra' 'builders' 'threebot') 
  for s in ${strs[@]};
  do cd /sandbox/code/github/threefoldtech/
  rm -rf /sandbox/code/github/threefoldtech/jumpscaleX_$s
  git clone https://github.com/threefoldtech/jumpscaleX_$s.git --branch development
  done
  source /sandbox/env.sh
  jsx generate

script:
  - name: Sal Tests
    cmd: | 
      source /sandbox/env.sh
      cd /sandbox/code/github/threefoldtech/jumpscaleX_core/cmds/
      ./js_testrun --with-xml  --xml-path /test.xml --xml-testsuite-name "sal_tests" -o "j.sal"
      yes | bcdb delete --all
  - name: Data Tests
    cmd: |
      source /sandbox/env.sh
      cd /sandbox/code/github/threefoldtech/jumpscaleX_core/cmds/
      ./js_testrun --with-xml  --xml-path /test.xml --xml-testsuite-name "data_tests" -o "j.data"
      yes | bcdb delete --all
  - name: Tools Tests
    cmd: |
      source /sandbox/env.sh
      cd /sandbox/code/github/threefoldtech/jumpscaleX_core/cmds/
      ./js_testrun --with-xml  --xml-path /test.xml --xml-testsuite-name "tools_tests" -o "j.tools"
      yes | bcdb delete --all
  - name: Clients Tests
    cmd: | 
      source /sandbox/env.sh
      cd /sandbox/code/github/threefoldtech/jumpscaleX_core/cmds/
      ./js_testrun --with-xml  --xml-path /test.xml --xml-testsuite-name "clients_tests" -o "j.clients"
      yes | bcdb delete --all
  - name: Servers Tests
    cmd: |
      source /sandbox/env.sh
      cd /sandbox/code/github/threefoldtech/jumpscaleX_core/cmds/
      ./js_testrun --with-xml  --xml-path /test.xml --xml-testsuite-name "servers_tests" -o "j.servers"
      yes | bcdb delete --all
  - name: Core Tests
    cmd: |
      source /sandbox/env.sh
      cd /sandbox/code/github/threefoldtech/jumpscaleX_core/cmds/
      ./js_testrun --with-xml  --xml-path /test.xml --xml-testsuite-name "core_tests" -o "j.core"
      yes | bcdb delete --all
